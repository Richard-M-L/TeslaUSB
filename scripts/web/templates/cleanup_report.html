{% extends "base.html" %}

{% block title %}æ¸…ç†æŠ¥å‘Š - Tesla USB å·¥å…·ç®±{% endblock %}

{% block head %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/cleanup.css') }}">
{% endblock %}

{% block content %}
<div class="cleanup-container">
    {% if dry_run %}
        <h1>ğŸ§ªæ¨¡æ‹Ÿè¿è¡Œå®Œæˆ</h1>
        <div class="alert alert-info">
            <h2>â„¹ï¸ æ¨¡æ‹Ÿæ¨¡å¼</h2>
            <p>è¿™æ˜¯ä¸€æ¬¡æµ‹è¯•è¿è¡Œ â€” æ²¡æœ‰å®é™…åˆ é™¤ä»»ä½•æ–‡ä»¶ã€‚</p>
            <p>ä»¥ä¸‹ç»“æœæ˜¾ç¤ºå¦‚æœæ‰§è¡ŒçœŸå®æ¸…ç†ï¼Œ<em>å°†ä¼šåˆ é™¤</em> å“ªäº›å†…å®¹ã€‚</p>
        </div>
    {% else %}
        <h1>âœ… æ¸…ç†å®Œæˆ</h1>
        <div class="alert alert-success">
            <h2>ğŸ‰ æ–‡ä»¶åˆ é™¤æˆåŠŸ</h2>
            <p>æ‚¨çš„æ¸…ç†æ“ä½œå·²æˆåŠŸå®Œæˆã€‚</p>
        </div>
    {% endif %}

    <!-- Summary -->
    <div class="report-summary">
        <div class="summary-card">
            <div class="summary-icon">ğŸ—‘ï¸</div>
            <div class="summary-content">
                <h3>{{ deleted_count }}</h3>
                <p>ä¸ªè§†é¢‘{% if dry_run %}å·² {% endif %}åˆ é™¤</p>
            </div>
        </div>

        <div class="summary-card">
            <div class="summary-icon">ğŸ’¾</div>
            <div class="summary-content">
                <h3>{{ deleted_size_gb }} GB</h3>
                <p>ç©ºé—´ {% if dry_run %}å·² {% endif %}é‡Šæ”¾</p>
            </div>
        </div>
    </div>

    {% if not dry_run and partition_usage %}
    <!-- Updated Storage Status -->
    <div class="storage-update">
        <h2>ğŸ“Š æ›´æ–°åçš„å­˜å‚¨çŠ¶æ€</h2>
        <div class="partition-card">
            <h3>ğŸš— TeslaCam å­˜å‚¨åˆ†åŒº</h3>
            <div class="storage-stat">
                <span class="stat-label">æ€»å®¹é‡:</span>
                <span class="stat-value">{{ partition_usage['total_gb'] }} GB</span>
            </div>
            <div class="storage-stat">
                <span class="stat-label">å·²ä½¿ç”¨:</span>
                <span class="stat-value">{{ partition_usage['used_gb'] }} GB ({{ "%.1f"|format(partition_usage['percent_used']) }}%)</span>
            </div>
            <div class="storage-stat">
                <span class="stat-label">å‰©ä½™:</span>
                <span class="stat-value">{{ partition_usage['free_gb'] }} GB</span>
            </div>

            <div class="progress-bar-container">
                <div class="progress-bar progress-normal"
                     style="width: {{ partition_usage['percent_used'] }}%"></div>
            </div>
        </div>
    </div>
    {% endif %}

    <!-- Action Buttons -->
    <div class="button-group">
        <a href="{{ url_for('analytics.dashboard') }}" class="btn btn-primary">
            ğŸ“Š æŸ¥çœ‹å­˜å‚¨åˆ†æä»ªè¡¨ç›˜
        </a>
        <a href="{{ url_for('videos.file_browser') }}" class="btn btn-secondary">
            ğŸ¥ æµè§ˆè§†é¢‘æ–‡ä»¶
        </a>
        <a href="{{ url_for('cleanup.settings') }}" class="btn btn-secondary">
            âš™ï¸ æ¸…ç†è®¾ç½®
        </a>
        {% if dry_run %}
        <a href="{{ url_for('cleanup.preview') }}" class="btn btn-danger">
            â–¶ï¸ æ‰§è¡ŒçœŸå®æ¸…ç†
        </a>
        {% endif %}
    </div>

    {% if not dry_run %}
    <div class="help-text">
        <h3>â„¹ï¸ åç»­æ“ä½œå»ºè®®</h3>
        <ul>
            <li>å‰å¾€ <strong>åˆ†æä»ªè¡¨ç›˜</strong> æŸ¥çœ‹æ›´æ–°åçš„å­˜å‚¨ä½¿ç”¨æƒ…å†µ</li>
            <li>é€šè¿‡ <strong>æµè§ˆè§†é¢‘</strong> åŠŸèƒ½ç¡®è®¤è¢«åˆ é™¤çš„æ–‡ä»¶æ˜¯å¦æ­£ç¡®</li>
            <li>å¦‚éœ€è°ƒæ•´è§„åˆ™ï¼Œå¯è¿”å› <strong>æ¸…ç†è®¾ç½®</strong> é¡µé¢</li>
            <li>è€ƒè™‘å¼€å¯ <strong>è‡ªåŠ¨å®šæ—¶æ¸…ç†</strong> ï¼Œè®©ç³»ç»Ÿå®šæœŸç»´æŠ¤ç©ºé—´</li>
        </ul>
    </div>
    {% endif %}
</div>
{% endblock %}
